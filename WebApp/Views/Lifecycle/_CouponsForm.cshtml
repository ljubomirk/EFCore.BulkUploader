@using Microsoft.AspNetCore.Html;
@model WebApp.ViewModels.LifecycleUpdateViewModel;


@using (Html.BeginForm("Update", "Lifecycle", FormMethod.Post, new { role = "form", id = "UpdateCoupons" }))
{
    <partial name="_CouponsUpdateFields" />
    <partial name="_CouponsTable" />
}


<script>
    $(document).ready(function () {
       // TODO: form submit async - button loading
    });

</script>


@functions{
    /// <summary>
    /// Validation messages helper
    /// </summary>
    /// <param name="viewData">Context</param>
    /// <param name="property">Model property</param>
    /// <param name="date">Bool for date input validation</param>
    /// <returns>Icon displaying validation messages inside tooltip</returns>
    /// <remarks>If date input, it returns an icon</remarks>
    public static HtmlString ValidationHelper(ViewDataDictionary context, string property, bool date)
    {
        if (context.ModelState[property] != null && context.ModelState[property].Errors.Any())
        {
            string msg = "";
            for (int i = 0; i < context.ModelState[property].Errors.Count; i++)
            {
                msg += context.ModelState[property].Errors[i].ErrorMessage;
            }
            msg.Trim();

            return new HtmlString(@"<i class='material-icons suffix validation-error' data-position='bottom' data-tooltip='" + msg + "'>warning</i>");
        }
        else if (date)
        {
            return new HtmlString(@"<i class='material-icons suffix date-icon'>event</i>");
        }
        return null;
    }
}